{"name":"hm","tagline":"Archaeological sequence diagrams and chronological models","body":"# hm\r\n=============\r\n\r\nWrite Graphviz `dot` files for archaeological sequence diagrams and chronological models.  Convert a sequence diagram to a chronological model.\r\n\r\n## Requirements\r\n\r\nThe `hm` package is Common Lisp software that runs on [SBCL](http://www.sbcl.org/) or [Clozure CL](http://ccl.clozure.com/).\r\n\r\nIt is convenient to install the software with [the `git` distributed version control system](http://git-scm.com/).\r\n\r\nThe output file produced by the `hm` package is source code for [Graphviz `dot`](http://www.graphviz.org/).\r\n \r\n## Install\r\n\r\nInstallation with [Quicklisp](http://www.quicklisp.org) is recommended.  It automatically installs [dependencies](http://eschulte.github.io/graph/).\r\n\r\n`cd ~/quicklisp/local-projects/`\r\n\r\n`git clone https://github.com/tsdye/harris-matrix.git`\r\n\r\n## Load\r\n\r\n`(ql:quickload \"hm\")`\r\n\r\n`(in-package hm)`\r\n\r\n## Draw\r\n\r\n`(hm-draw \"path/to/configuration/file\")`\r\n\r\n## Overview\r\n\r\nThe `hm` package produces Graphviz `dot` source code for archaeological sequence diagrams from tables of stratigraphic observations, inferences, and interpretations.  With the addition of a table of radiocarbon dates, the `hm` package will produce a Bayesian chronological model.\r\n\r\nThe `hm` package provides a single function, `hm-draw`, which expects a valid path to a configuration file as its sole argument.\r\n\r\nThe configuration file specifies paths to one or more data files and sets values for several dozen Graphviz `dot` variables.\r\n\r\nThe configuration information and the data are held in comma separated value files.  Together, the configuration and data files can hold a complete description of site stratigraphy and its interpretation. \r\n\r\n## Example Output\r\n\r\nThe stratigraphic section shown in Figure 12 of Edward Harris' book, _Principles of Archaeological Stratigraphy_.  Note that the symbol for a deposit is a box and for an interface a trapezium. In this example, the nodes are colored according to the directed graph concept of _level_.\r\n\r\n![fig-12-harris-levels-tred.svg](http://harris-matrix.tsdye.com/img/fig-12-harris-levels-tred.svg)\r\n\r\nAnother view of the stratigraphic section shown in Figure 12 of Edward Harris' book, _Principles of Archaeological Stratigraphy_.  In this example, layer interfaces are recognized and the nodes are colored to reflect the relationship of Context 4 to other contexts in a Bayesian chronological model.\r\n\r\n![fig-12-distance-from-4-layer-interfaces-set24-tred.svg](http://harris-matrix.tsdye.com/img/fig-12-distance-from-4-layer-interfaces-set24-tred.svg)\r\n\r\nAn example H-structure from Steve Roskams' book, _Excavation_.\r\n\r\n![Roskams' H Structure](http://harris-matrix.tsdye.com/img/roskams-h-tred.svg)\r\n\r\nA complex H-structure from Steve Roskams' book, _Excavation_, with nodes colored according to reachability from Context 2.  The node coloring resolves potential ambiguities in the diagram.\r\n\r\n![Roskams's Fig. 9.5](http://harris-matrix.tsdye.com/img/hs95a-reachable-from-2-tred.svg)\r\n\r\nA complex H-structure from Steve Roskams' book, _Excavation_, with nodes colored according to reachability from Context 4.\r\n\r\n![Roskams's Fig. 9.5](http://harris-matrix.tsdye.com/img/hs95a-reachable-from-4-tred.svg)\r\n\r\nSequence diagrams sometimes require \"jumps\" or \"crossings\".  This is an example from Figure 13 of Steve Roskams' book, _Excavation_.\r\n\r\n![Roskams' jumps](http://harris-matrix.tsdye.com/img/roskams-jumps-tred.svg)\r\n## Data Tables\r\n\r\nThere are seven data tables used as input to `hm`.  Examples of each are provided in the `hm` git repository.\r\n\r\n### Units of Stratification\r\n\r\nThis table describes the contexts identified by the archaeologist.\r\n\r\n-   **label:** context identifier (primary key)\r\n-   **unit-type:** interface or deposit\r\n-   **position:** surface/basal/other\r\n-   **period:** period identifier (foreign key)\r\n-   **phase:** phase identifier (foreign key)\r\n-   **url:** node link (svg output only)\r\n\r\n### Observed Stratigraphic Relations\r\n\r\nThis table includes observations of stratigraphic superposition.  Its\r\nfirst two columns refer to values from the `label` column of the\r\ncontexts table.\r\n\r\n-   **younger:** stratigraphically superior context label (foreign key)\r\n-   **older:** stratigraphically inferior context label (foreign key)\r\n-   **url:** arc link (svg output only)\r\n\r\n### Inferred Parity Relations\r\n\r\nThis table contains inferences of parity between pairs of\r\ndiscontiguous contexts.\r\n\r\n-   **first:** context label (foreign key)\r\n-   **second:** context label (foreign key)\r\n\r\n### Periods\r\n\r\nThis table describes periods, which are groups of interfacial contexts believed to have been in use at the same time.\r\n\r\n-   **id:** a unique integer to identify the period (primary key)\r\n-   **label:** name of the period used in the legend\r\n-   **color:** zero-based integer scale for a [Brewer color](http://www.graphviz.org/doc/info/colors.html#brewer)\r\n-   **description:** optional field not used by `hm`\r\n\r\n### Phases\r\n\r\nThis table describes phases, which are groups of depositional contexts believed to have been deposited pene-contemporaneously, typically because they share diagnostic artifactual content.\r\n\r\n-   **id:** a unique integer to identify the phase (primary key)\r\n-   **label:** name of the phase used in the legend\r\n-   **color:** zero-based integer scale for a [Brewer color](http://www.graphviz.org/doc/info/colors.html#brewer)\r\n-   **description:** optional field not used by `hm`\r\n\r\n### Dates\r\n\r\nThis table associates radiocarbon dates with events and contexts.\r\n\r\n- **theta:** unique label (primary key)\r\n- **context:** context identifier (foreign key)\r\n- **lab:** dating laboratory identifier\r\n\r\n### Date Order\r\n\r\nThis optional table contains information on the temporal order of dated events from the same context.\r\n\r\n- **older:** theta label of older date (foreign key)\r\n- **younger:** theta label of younger date (foreign key)\r\n\r\n\r\n## Configuration File\r\n\r\nAn empty configuration file is included in the repository as examples/empty-configuration-file.csv.\r\n\r\nIn addition, each of the examples comes with its own configuration file.\r\n\r\n# Plotting the Sequence Diagram\r\n\r\nI have two shell scripts to automate graph plotting on my Mac OS X system.  They each take two arguments:\r\n* path to the `dot` file, without file extension\r\n* [output file type](http://www.graphviz.org/content/output-formats)\r\n\r\nThis one simply plots and opens the graph.  It will display all the arcs.\r\n\r\n`dot -T$2 $1.dot -o $1.$2`\r\n\r\n`open $1.$2`\r\n\r\nThis one plots and opens the transitive reduction of the graph.  Transitive reduction corresponds to Harris' Law of Stratigraphical Succession.\r\n\r\n`tred $1.dot > $1-tred.dot`\r\n\r\n`dot -T$2 $1-tred.dot -o $1-tred.$2`\r\n\r\n`open $1-tred.$2`\r\n\r\n# Workflow\r\n\r\nLegends are displayed as elements; no attempt at good layout is made.  The `svg` output from `dot` can be edited with an application such as [Inkscape](http://www.inkscape.org/en/).","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}